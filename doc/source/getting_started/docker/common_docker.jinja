Launch the Speos service
------------------------

Manually launch the Speos service.

Environment variables
^^^^^^^^^^^^^^^^^^^^^

The Speos service requires this mandatory environment variable for its use:

* ``ANSYSLMD_LICENSE_FILE``: License server (port and IP address or DNS) that the Speos service is to
  connect to. For example, ``1055@127.0.0.1``.

You can also specify other optional environment variables:

* ``SPEOS_LOG_LEVEL``: Sets the Speos service logging level. The default is ``2``, in which case
  the logging level is ``INFO``.

Here are some terms to keep in mind:

* **host**: Machine that hosts the Speos service. It is typically on ``localhost``, but if
  you are deploying the service on a remote machine, you must pass in this host machine's
  IP address when connecting. By default, PySpeos assumes it is on ``localhost``.

* **port**: Port that exposes the Speos service on the host machine. Its
  value is assumed to be ``50051``, but users can deploy the service on preferred ports.


Speos service launcher
^^^^^^^^^^^^^^^^^^^^^^

This method requires that you manually launch the Speos service. Remember to pass
in the different environment variables that are needed. Afterwards, see the next section
to understand how to connect to this service instance from PySpeos.

.. tab-set::

    .. tab-item:: Linux/Mac

        .. code-block:: bash

            docker run \
                --name speos-rpc \
                -e ANSYSLMD_LICENSE_FILE=<LICENSE_SERVER> \
                -e SPEOS_LOG_LEVEL=<LOG_LEVEL> \
                -p 50051:50051 \
                ghcr.io/ansys-internal/speos-rpc:<TAG>

    .. tab-item:: Powershell

        .. code-block:: pwsh

            docker run `
                --name speos-rpc `
                -e ANSYSLMD_LICENSE_FILE=<LICENSE_SERVER> `
                -e SPEOS_LOG_LEVEL=<LOG_LEVEL> `
                -p 50051:50051 `
                ghcr.io/ansys-internal/speos-rpc:<TAG>

    .. tab-item:: Windows CMD

        .. code-block:: bash

            docker run ^
                --name speos-rpc ^
                -e ANSYSLMD_LICENSE_FILE=<LICENSE_SERVER> ^
                -e SPEOS_LOG_LEVEL=<LOG_LEVEL> ^
                -p 50051:50051 ^
                ghcr.io/ansys-internal/speos-rpc:<TAG>

Connect to the Speos service
----------------------------

After the Speos service is launched, connect to it with these commands:

.. code:: python

   from ansys.speos.core import Speos

   speos = Speos()

By default, the ``Speos`` instance connects to ``127.0.0.1`` (``"localhost"``) on
port ``50051``.

You can change this by modifying the ``host`` and ``port``
parameters of the ``Speos`` object, but note that you must also modify
your ``docker run`` command by changing the ``<HOST-PORT>-50051`` argument.

The following tabs show the commands that set the environment variables and ``Speos``
function.

.. code:: python

    from ansys.speos.core import Speos

    speos = Speos(host="127.0.0.1", port=50051)